---
## Front matter
title: "Математическая модель «хищник–жертва»"
subtitle: "Построение с помощью python"
author: "Коннова Татьяна Алексеевна"
## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: false # List of tables
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: PT Serif
romanfont: PT Serif
sansfont: PT Sans
monofont: PT Mono
mainfontoptions: Ligatures=TeX
romanfontoptions: Ligatures=TeX
sansfontoptions: Ligatures=TeX,Scale=MatchLowercase
monofontoptions: Scale=MatchLowercase,Scale=0.9
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
---
# Аннотация
  В данной работе рассматривается построение математической модели «хищник–жертва» с использованием языка программирования Python. 
  Модель основана на системе дифференциальных уравнений Лотки-Вольтерры и визуализирована с помощью библиотек NumPy и Matplotlib.
  Исследуется динамика популяций хищников и жертв при различных начальных условиях.

# Введение

Изучение динамики взаимодействующих популяций является одной из фундаментальных задач математической биологии и экологии. Особый интерес представляет система типа «хищник—жертва», где судьба одного вида неразрывно связана с другим. Понимание закономерностей изменения численности таких популяций во времени, а также анализ того, как колебания численности жертв влияют на динамику хищников при заданных начальных условиях, имеет критическое значение для прогнозирования состояния экосистем, управления биоресурсами и оценки последствий антропогенного воздействия.

Первое математически строгое описание этой сложной биологической взаимосвязи было предложено в классических работах Альфреда Лотки (1925 г.) и Вито Вольтерры (1926 г.). Несмотря на независимость их исследований, оба ученых пришли к сходной системе нелинейных обыкновенных дифференциальных уравнений, получившей впоследствии название модели Лотки-Вольтерры. Импульсом для этих работ послужила практическая задача: необходимость объяснить наблюдавшиеся итальянскими биологами после Первой мировой войны резкие колебания численности промысловых рыб (жертвы) и морских хищников в Средиземном море.

Модель Лотки-Вольтерры описывает замкнутую систему из двух видов, где:

Популяция жертв: Растет с постоянной скоростью (например, экспоненциально) в отсутствие хищников, но сокращается пропорционально частоте встреч с ними (и, соответственно, численности обоих видов).

Популяция хищников: Вымирает с постоянной скоростью в отсутствие жертв (из-за недостатка пищи), но увеличивает свою численность за счет потребления жертв, причем скорость роста также пропорциональна частоте встреч.

Эта элегантная модель качественно объясняет наблюдаемые в природе циклические колебания численности хищников и жертв, причем пик численности хищников закономерно следует за пиком численности жертв. Она стала краеугольным камнем математической экологии, заложив основы для анализа межвидовых взаимодействий и динамики биоценозов. Однако, будучи идеализированной (пренебрегая такими факторами, как внутривидовая конкуренция, насыщение хищников, сложная структура среды, миграции, времязапаздывание, стохастичность и т.д.), модель Лотки-Вольтерры имеет известные ограничения в точном количественном описании реальных систем [@гасратова2014математическая], [@шубина2016одной].

Целью данной научной работы является детальное исследование динамики численности популяций хищника и жертвы во времени, описываемой моделью Лотки-Вольтерры, с акцентом на анализ зависимости изменения численности хищников от изменения численности жертв. Особое внимание будет уделено изучению влияния различных начальных условий (начального соотношения численностей хищника и жертвы) на характер возникающих колебаний, фазовый портрет системы и взаимную динамику популяций. Это исследование позволит глубже понять механизмы, лежащие в основе колебательного режима, и оценить чувствительность системы к стартовым параметрам в рамках классической модели.

# Методы

В данной работе используется классическая математическая модель хищник-жертва, основанная на системе дифференциальных уравнений Лотки-Вольтерры. Для описания динамики популяций жертв и хищников применяются две взаимосвязанные функции, отражающие скорость роста популяции жертв при отсутствии хищников и скорость убыли популяции хищников при отсутствии пищи. Модель включает параметры, характеризующие коэффициенты рождаемости, смертности и интенсивность взаимодействия между видами. Решение системы уравнений осуществляется численными методами, такими как метод Рунге-Кутты четвёртого порядка, что позволяет исследовать поведение системы во времени при различных начальных условиях и параметрах. Анализ устойчивости равновесных точек проводится с помощью линейного приближения и вычисления собственных значений якобиана системы.

Основные уравнения модели [@гладких2015математическая], [@громазина2017использование]:

$$
\begin{cases}
  \dot x = ax - bxy \\
  \dot y = cxy - dy,
\end{cases}
$$

где:

$x(t)$ - численность популяции жертв в момент времени $t$

$y(t)$ - численность популяции хищников в момент времени $t$

$a$ - коэффициент естественного прироста жертв (рождаемость)

$b$ - коэффициент смертности жертв от хищников

$c$ - коэффициент прироста хищников за счет жертв

$d$ - коэффициент естественной смертности хищников

# Результаты

Для численного исследования поведения модели Лотки-Вольтерры и визуализации динамики популяций был разработан программный код на языке Python с использованием библиотек `numpy`, `matplotlib` и `scipy.integrate.odeint` для решения системы дифференциальных уравнений. Исследование включало построение двух ключевых типов графиков: динамики численности во времени и фазового портрета (зависимости численности хищников от численности жертв).

Следующий код реализует решение системы уравнений Лотки-Вольтерры для заданных параметров и начальных условий и строит графики изменения численности жертв `x(t)` и хищников `y(t)` в зависимости от времени:

**Код для построения графика динамики численности популяций по времени: **

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import odeint

# Параметры модели
a = 0.2   # коэффициент прироста жертв
b = 0.5  # коэффициент смертности жертв из-за хищников
c = 0.05  # коэффициент прироста хищников из-за жертв
d = 0.02   # коэффициент смертности хищников

# Сист. ур.
def model(populations, t):
    x, y = populations  # x - популяция жертв, y - популяция хищников
    dxdt = -a * x + c * x * y  # изменение популяции жертв
    dydt = -d * x * y + b * y   # изменение популяции хищников
    return [dxdt, dydt]

# Нач. условия
initial_conditions = [40, 9]  # начальные значения (жертвы, хищники)
t = np.linspace(0, 100, 100)  # временной интервал

# Решение дифф. ур.
solution = odeint(model, initial_conditions, t)

# Извлечение значений популяций
x_population = solution[:, 0]  # популяция жертв
y_population = solution[:, 1]  # популяция хищников

plt.figure(figsize=(10, 5))
plt.plot(t, x_population, label='Популяция жертв (x)', color='green')
plt.plot(t, y_population, label='Популяция хищников (y)', color='red')
plt.xlabel('Время')
plt.ylabel('Численность')
plt.title('Динамика численности популяций по времени.')
plt.legend()
plt.grid()
plt.show()
```
Результат:

![Динамика численности популяций по времени](./image/img_4.png){#fig:001 width=70%}

На графике динамики численности (рис. [-@fig:001]) отчетливо наблюдаются **периодические колебания** обеих популяций, что является характерным поведением модели Лотки-Вольтерры. Анализ графика позволяет выявить следующие закономерности:

1.  **Сдвиг фаз:** Пик численности популяции жертв *предшествует* пику численности популяции хищников. Это объясняется биологически: сначала растет количество пищи (жертв), что создает условия для последующего роста числа хищников. Рост хищников приводит к усилению пресса на жертв и снижению их численности, что затем вызывает спад численности самих хищников из-за нехватки пищи. После снижения численности хищников давление ослабевает, и цикл повторяется.

2.  **Амплитуда и период:** Амплитуда колебаний популяции хищников (красная кривая) заметно больше, чем амплитуда колебаний популяции жертв (зеленая кривая) при выбранных параметрах и начальных условиях. Период колебаний составляет примерно.

3.  **Равновесные точки:** Видно, что система не приходит к статическому равновесию, а постоянно колеблется вокруг **неустойчивого положения равновесия**, соответствующего средним значениям численностей. Эти средние значения определяются параметрами модели (`x* = d/c`, `y* = a/b`). Для данных параметров: `x* = 0.02 / 0.05 = 0.4`, `y* = 0.2 / 0.5 = 0.4`. Однако на графике (с начальными условиями [40, 9]) средние значения значительно выше расчетных `[0.4, 0.4]`. Это несоответствие требует проверки корректности модели и параметров.

4.  **Начальные условия:** Выбранные начальные условия `[40, 9]` демонстрируют типичные колебания. Запуск модели с другими начальными условиями (как будет показано далее) изменит фазовую траекторию, но колебательный характер сохранится.

**2. Фазовый портрет: Зависимость численности хищников от численности жертв**

Для анализа взаимного влияния популяций и исследования структуры фазового пространства был построен фазовый портрет системы. На нем отображается траектория системы в координатах `(x, y)` - численность жертв по оси X, численность хищников по оси Y.

Далее построим с помощью python график, отражающий зависимости изменения численности хищников от изменения численности жертв с начальными значениями:

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import odeint

# Параметры модели
a = 0.2   # коэффициент прироста жертв
b = 0.5  # коэффициент смертности жертв из-за хищников
c = 0.05  # коэффициент прироста хищников из-за жертв
d = 0.02   # коэффициент смертности хищников

# Система уравнений
def model(populations, t):
    x, y = populations  # x - популяция жертв, y - популяция хищников
    dxdt = -a * x + c * x * y  # изменение популяции жертв
    dydt = -d * x * y + b * y   # изменение популяции хищников
    return [dxdt, dydt]

# Функция для построения графика
def plot_population_graph(initial_conditions, time_range):
    t = np.linspace(time_range[0], time_range[1], 1000)  # временной интервал
    solution = odeint(model, initial_conditions, t)

    x_population = solution[:, 0]  # популяция жертв
    y_population = solution[:, 1]  # популяция хищников

    # Построение графика
    plt.figure()
    plt.plot(x_population, y_population, label='''Зависимости изменения 
    численности''', color='blue')
    plt.xlabel('Популяция жертв (x)')
    plt.ylabel('Популяция хищников (y)')
    plt.title('''Зависимости изменения численности хищников 
    от изменения численности жертв с начальными значениями''')
    plt.grid()
    plt.legend()
    plt.show()

# Начальные условия
initial_conditions = [10, 5]  # начальные значения (жертвы, хищники)
time_range = (0, 400)  # временной диапазон

# Вызов функции для построения графика
plot_population_graph(initial_conditions, time_range)
```

Результат:

![Зависимости изменения численности хищников от изменения численности жертв с начальными значениями](./image/img_6.png){#fig:002 width=70%}

По графику (рис. [-@fig:002]) видно, что траектория представляет собой замкнутую кривую, что соответствует периодическим колебаниям.

Ключевые выводы по графику:

1. **Замкнутость траектории**: Система демонстрирует периодическое поведение. Это означает, что изменения численности хищников и жертв повторяются с течением времени. Замкнутость кривой указывает на отсутствие затухания или роста амплитуды колебаний, что характерно для консервативной системы.

2. **Направление движения**: Движение по фазовой траектории происходит против часовой стрелки. Это видно по начальному движению:

- В начале (точка [10,5]): при малом количестве жертв (x=10) хищники (y=5) не могут эффективно размножаться, поэтому численность хищников сначала падает (движение вниз), а жертвы, имея мало хищников, начинают размножаться (движение вправо). Затем, по мере роста жертв, хищники получают больше пищи и их численность растет (движение вверх и вправо, затем вверх и влево). После этого, из-за большого количества хищников, численность жертв сокращается (движение влево), а затем, из-за недостатка пищи, падает и численность хищников (движение вниз), возвращаясь к начальной точке.

3. **Амплитуда и форма колебаний**:

- Минимальное и максимальное значение популяции жертв (x): примерно от 5 до 45.

- Минимальное и максимальное значение популяции хищников (y): примерно от 2 до 20.

- Форма траектории эллиптическая, но вытянутая, что отражает нелинейность системы.

4. **Влияние начальных условий**: Начальные условия [10,5] определяют амплитуду и смещение колебаний. Если бы начальные условия были ближе к стационарной точке, амплитуда колебаний была бы меньше. В данном случае начальная точка далека от равновесия, поэтому амплитуда велика.

5. **Фазовый сдвиг**: График показывает, что изменения численности хищников отстают от изменений численности жертв. Это видно по тому, что при увеличении численности жертв (движение вправо) численность хищников еще не растет (нижняя часть эллипса), а затем, когда жертв уже много, хищники начинают размножаться (движение вверх).

6. **Соотношение хищник-жертва**: Из графика видно, что пик численности хищников наступает позже пика численности жертв. Это классическое поведение для модели Лотки-Вольтерры.

7. **Устойчивость**: Траектория замкнутая и изолированная, что указывает на устойчивость колебаний. Система будет бесконечно долго двигаться по этой траектории, если параметры не изменятся.

8. **Биологическая интерпретация**: Полученный график иллюстрирует цикличность в природе: за ростом жертв следует рост хищников, который затем приводит к падению численности жертв, а затем и хищников. После снижения давления хищников популяция жертв восстанавливается, и цикл повторяется.

Таким образом, фазовый портрет наглядно демонстрирует циклический характер взаимодействия двух популяций, предсказанный моделью Лотки-Вольтерры.


# Выводы

В процессе выполнения данной лабораторной работы была реализована модель "хищник-жертва" на языке программирования Python. Данная модель основана на системе дифференциальных уравнений Лотки-Вольтерры и была визуализирована с помощью библиотек NumPy и Matplotlib.
В рамках данной работы была исследована динамика популяций хищников и жертв при различных начальных условиях. Была построена математическая модель, которая позволяет описать взаимодействие между двумя видами и исследовать влияние различных факторов на динамику популяций.
Проведенное исследование подтвердило, что модель Лотки-Вольтерры, несмотря на свою простоту, качественно верно описывает фундаментальные принципы взаимодействия видов. Реализация модели на Python с визуализацией средствами Matplotlib предоставила мощный инструмент для анализа динамики экосистем. Полученные результаты подчеркивают необходимость учета начальных условий при прогнозировании популяционной динамики и разработке природоохранных стратегий.

# Список литературы{.unnumbered}

::: {#refs}
:::